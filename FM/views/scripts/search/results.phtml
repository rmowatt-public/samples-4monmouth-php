<div id="searchResults" class="holygrail">
    <div class="col2">
        <div id="focusOnSponsors">
            <img class="fosbanner" src="/images/focusonsponsors.gif" />
            <?php echo $this->banners; ?>
        </div>
    </div>
    <div class="col1">
        <?php $high = ($this->total > 12) ? '12' : $this->total; ?>
        <h2>Search Results: <span class="green resultCount">1 - 
                <?php echo $high;  ?>
            </span>of 
            <?php echo $this->total; ?>
            <span class="pages">
                <?php $pages = ceil(count($this->clients) / 12);
                     $i = 0;
                     $totalClients = count($this->clients);
                     if($this->total > 12) {
                     	echo 'pages&nbsp;:&nbsp;';
						echo '<a href="#" rel="previous" class="action">&laquo;</a>';
                     	while($i < $pages) {
                     		$page = $i + 1;
                     		echo '<a href="#" rel="'.$page.'">'.$page.'</a>';
                     		$i++;
                     	}
						echo '<a href="#" rel="next" class="action">&raquo;</a>';
                     }
                 	?>
            </span></h2>
            <div class="clear">&nbsp;</div>
        <div class="results">
            <div id="colorbox_gmap">
                <div id="gmap">
                    <form class="zend_form">
                        <label>FROM:</label>
                        <input class="direction_from" name="direction_from" id="direction_from" type="text"/>
                        <input type="submit" id="submit"value="get directions"/>
                        <input name="direction_to" id="direction_to"  type="hidden" type="text" value=""/>
                    </form>
                    <div id="map_canvas"></div>
                    <div id="directionsPanel"></div>
                </div>
                <script type="text/javascript" src='/js/tabs/directions.js'></script>
            </div>
            <?php
            if(!count($this->clients)) {?>
            	<div>No matches found. Please try again.</div>
           <?php }
                $i = 0;
                $j = 1;
                $k = 0;
                foreach($this->clients as $index=>$client) {?>
            <?php if($i == 0 && $j > 1) { ?>
            <div style="display:none" id="result_<?php echo $j; ?>">
                <?php } elseif($i == 0 && $j == 1) { 
                	//print $client['type'];
                	switch ($client['type']) {
                            		case 2:
                            			$type = 'merchant';
                            			break;
                            		case 3:
                            			$type = 'org';
                            			break;
                            		case 4:
                            			$type = 'sports';
                            			break;
                            		default:
                            			break;
                            	} ?>
                <div id="result_<?php echo $j; ?>">
                    <?php } ?>
                    <div class="searchListing" rel="<?php echo $k+1; ?>">
                      <?php if ($client['active'] == 1) { ?>
                       <a href="/<?php echo $type; ?>/<?php echo $client['id']; ?>" target="_blank"> 
                       <?php } ?>
                       <img class="searchInfoImg" src="/media/image/icons/<?php echo ($client['icon'] != '') ? $client['icon'] : 'no_logo.jpg'; ?>">
                       <?php if ($client['active'] == 1) { ?>
                       	</a>
                       	<?php } ?>
                        <div class="searchInfoAddress">
                            <h4>
                                <?php echo stripslashes($client['name']);?>
                            </h4>
                            <div class="address"><?php echo trim($client['address1'], " "); ?></div>
                            <div class="city"><?php echo($client['city'] != '') ? $client['city'] . ',' : ''; ?> <?php echo $client['state']; ?> <?php echo $client['zip']; ?></div>
                            <div class="phone">
                                <?php echo $client['phone']; ?>
                            </div>
                        </div>
                        <div class="searchInfoProfile">
                            <?php echo ucwords(strtolower(substr($desc = strip_html_tags($client['description']), 0 , 225))); ?>
                            <?php if (strlen($desc) > 225) { echo '...&nbsp;';} ?>
                            <?php if ($client['active'] == 1) {
                            	
                            ?>
                            	<a href="/<?php echo $type; ?>/<?php echo $client['id']; ?>" target="_blank"><span class="green">read more</span></a>
                            <?}?>
                        </div>
                        <!--<a class="searchInfoMap" href="/merchant/<?php echo $client['id']; ?>"><img src="/images/search/map.gif" /></a>-->
                       <?php if ($client['address1'] != '' & $client['city'] != '') {?> <a class="searchInfoMap" href="#"><img src="/images/search/map.gif" /></a> <?}else {?>
                       <img src="/images/search/smallmap1-no.gif" height="40" width="40" /> <?}?>
                    </div>
                    <?php $i++;
                     $k++;
                     if($i == 12 || $k == $totalClients) { ?>
                </div>
                <?php } 
                if($i == 12){$i = 0;$j++;}
                	} ?>
            </div>
        
         <?php $high = ($this->total > 12) ? '12' : $this->total; ?>
        <h2>Search Results:
			<span class="green resultCount">1 - 
                <?php echo $high;  ?>
            </span>of 
            <?php echo $this->total; ?>
            <span class="pages">
                <?php $pages = ceil(count($this->clients) / 12);
                     $i = 0;
                     $totalClients = count($this->clients);
                     if($this->total > 12) {
                     echo 'pages&nbsp;:&nbsp;';
						echo '<a href="#" rel="previous" class="action">&laquo;</a>';
                     	while($i < $pages) {
                     		$page = $i + 1;
                     		echo '<a href="#" rel="'.$page.'">'.$page.'</a>';
                     		$i++;
                     	}
						echo '<a href="#" rel="next" class="action">&raquo;</a>';
                     }
                 	?>
            </span></h2>
            
            
    </div>
    <div class="searchFooter">
        <a href="/search">New Search</a>
    </div>
</div>

<script type="text/javascript"></script>
<?php
function strip_html_tags( $text )
{
	$text = preg_replace(
	array(
	// Remove invisible content
	'@<head[^>]*?>.*?</head>@siu',
	'@<style[^>]*?>.*?</style>@siu',
	'@<script[^>]*?.*?</script>@siu',
	'@<object[^>]*?.*?</object>@siu',
	'@<embed[^>]*?.*?</embed>@siu',
	'@<applet[^>]*?.*?</applet>@siu',
	'@<noframes[^>]*?.*?</noframes>@siu',
	'@<noscript[^>]*?.*?</noscript>@siu',
	'@<noembed[^>]*?.*?</noembed>@siu',
	// Add line breaks before and after blocks
	'@</?((address)|(blockquote)|(center)|(del))@iu',
	'@</?((div)|(h[1-9])|(ins)|(isindex)|(p)|(pre))@iu',
	'@</?((dir)|(dl)|(dt)|(dd)|(li)|(menu)|(ol)|(ul))@iu',
	'@</?((table)|(th)|(td)|(caption))@iu',
	'@</?((form)|(button)|(fieldset)|(legend)|(input))@iu',
	'@</?((label)|(select)|(optgroup)|(option)|(textarea))@iu',
	'@</?((frameset)|(frame)|(iframe))@iu',
	),
	array(
	' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ',
	"\n\$0", "\n\$0", "\n\$0", "\n\$0", "\n\$0", "\n\$0",
	"\n\$0", "\n\$0",
	),
	$text );
	return strip_tags( $text );
}
?>